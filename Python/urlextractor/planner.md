
---


## Part 1

利用 win32com 数据库 (ReportURLData.mdb), 从 表-股票代码 中读取所有股票名称和其名称并储存入字典当中；从 表-报告类型 中读取所有报告类型名称和其编码并储存入字典当中

向每一只股票发表公告全文的网站/网页发送返回其静态源代码的请求（默认访问URL为: http://stockdata.stock.hexun.com/2009_ggqw_股票代码.shtml）

获取静态源代码后，找出标签（例子： <a href="/2008/ggqw.aspx?page=1&stockid=000002">, 一般在427行），从标签内的 href 属性中获取 page 参数的值，即首页和尾页。同时，将 href 属性中的字符串的 page 参数后的值更改为 {}，以便于在翻页时进行字符串格式化

注意，page 参数和 stockid 参数的位置有可能不同

实例：
http://stockdata.stock.hexun.com/2008/ggqw.aspx?stockid=000002&page=1
http://stockdata.stock.hexun.com/2008/ggqw.aspx?page=1&stockid=000002

获取 page 参数值和已准备好进行字符串格式化的URL后，在每一只股票发表公告全文的网站进行翻页并发送返回其静态源代码的请求

获取静态源代码后，查找包含"...季度报告全文"或"...季度报告"或"...年度报告全文"或"...年度报告"的标签。一般会出现在424行，并拥有其标签结构：

<tr>
    <td class="add2">
        <a target="_blank" href="http://stockdata.stock.hexun.com/txt/stock_detail_txt_1207688281.shtml">民生银行：2020年第一季度报告（全文）</a>
    </td>
    <td class="add2_1">
        <a target="_blank" href="http://download.hexun.com/ftp/all_stockdata_2009/all/120\768\1207688281.pdf">查看pdf公告</a>
    </td>
    <td class="add2_1">2020-04-30</td>
</tr>

从上述标签结构获取报告下载链接（例: http://download.hexun.com/ftp/all_stockdata_2009/all/120\768\1207688281.pdf）

不要将所有页数翻完并将所有报告获取，只需获取比数据库内最新年度要相等或大的报告的即可（例如，最新年度为2011，获取2011和之后的报告）

处理报告标题包含的信息，即股票代码，股票名称，年度，报告类型和其报告编码

将处理好的信息，即股票代码，股票名称，年度，报告类型和其报告编码，和报告下载链接写入数据库 (ReportURLData.mdb) 中。

如果写入的信息和下载链接已存在数据库中，请略过。

错误处理，处理好网页请求失败，不规则数据等引起的错误

---


## Part 2

创建一个可视化窗口，可以通过其窗口对数据库 (ReportURLData.mdb) 中 表-PDF网址 内的下载链接进行访问。

窗口Features：

允许输入股票代码或股票名称进行查询

并且在输入股票代码或股票名称不完整时，可以是进行查询后，允许在输入处打开一个下拉菜单，显示与现有输入内容相关的股票代码或股票名称；或可以是自动弹出下挂菜单，显示与现有输入内容相关的股票代码或股票名称。

下拉菜单的内容允许点击并将现有不完整的输入内容进行完整

年度选择，输入或下拉菜单选择

报告类型，checkbox，允许多选

在以上信息完成并点击确认后，如果所述的下载链接在数据库存在，下载到本地；不存在，提示没有。


---
